@inject ClientPlanetManager planetManager

@if (embed != null) {
    <div class="embed">
        @if (embed.Items != null) {
            @foreach (ClientEmbedItem item in embed.CurrentlyDisplayed)
            {
                @switch (item.Type)
                {
                    case "Text":
                        <div style="@item.GetInlineStyle" class="embed-item">
                            @if (item.Name != null) {
                                <div style="color:#@item.TextColor;font-weight:bold;font-size:14px;">
                                    @item.DoMarkdown(item.Name)
                                </div>
                            }
                            <div style="color:#@item.TextColor;font-size:14px;">
                                @if (item.Link != null) {
                                    <a href="@item.Link" rel="nofollow" target="_blank">@item.DoMarkdown(item.Text)</a>
                                }
                                else {
                                    @item.DoMarkdown(item.Text)
                                }
                            </div>
                        </div>
                        break;
                    case "Button":
                        @if (item.Center) {
                            <center>
                                <EmbedButtonComponent Item="item" Message="Message" embed="embed"></EmbedButtonComponent>
                            </center>
                        }
                        else {
                            <EmbedButtonComponent Item="item" Message="Message" embed="embed"></EmbedButtonComponent>
                        }
                        break;
                    case "InputBox":
                        <EmbedinputBoxComponent Item="item" embed="embed"></EmbedinputBoxComponent>
                        break;
                }
            }
            @if (embed.HasPages()) {
                <div style="margin-left: 80%;">
                    <button @onclick="PrevPage" class="btn btn-primary btn-sm" style="display: inline-block;box-shadow: none;">&lt</button>
                    <p style="font-size:12px;display: inline-block;">@embed.CurrentPage</p>
                    <button @onclick="NextPage" class="btn btn-primary btn-sm" style="display: inline-block;box-shadow: none;">&gt</button>
                </div>
            }
        }
    </div>
}

@code {

    [Parameter]
    public ClientEmbed embed { get; set;}
    [Parameter]
    public ClientPlanetMessage Message {get; set;}

    protected async override Task OnInitializedAsync() {
        embed.UpdateCurrentlyDisplayed();
        StateHasChanged();
    }

    public void NextPage() {
        embed.NextPage();
        StateHasChanged();
    }

    public void PrevPage() {
        embed.PrevPage();
        StateHasChanged();
    }

}
